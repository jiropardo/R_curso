"0","#| include: false"
"0","### function para calcular crecimiento de ventas"
"0","#del producto respecto al año anterior"
"0","#| include: false"
"0","compare_ventas <- function(df, input_year) {"
"0","  # sort por año"
"0","  df_sorted <- df %>%"
"0","    arrange(Año)"
"0","  "
"0","  # encontrar fila "
"0","  row_index <- which(df_sorted$Año == input_year)"
"0","  "
"0","  # verificas si existe"
"0","  if(length(row_index) == 0) {"
"0","    return(""Año no encontrado en el dataset"")"
"0","  }"
"0","  "
"0","  # Comparar con la anteior "
"0","  if(row_index > 1) {"
"0","    current_ventas <- df_sorted$Total_Ventas_Producto_Anual[row_index]"
"0","    previous_ventas <- df_sorted$Total_Ventas_Producto_Anual[row_index - 1]"
"0","    "
"0","    # Vector for growth/decrease"
"0","    result_vector <- c(""crecimiento"", ""decrecimiento"", ""datos insuficientes con respecto al año anterior para confirmar crecimiento o decrecimiento"")"
"0","    "
"0","    # devoler ""Crecimiento"" si es mayor, ""Decrecimiento"" si es menor"
"0","    if(current_ventas > previous_ventas) {"
"0","      return(result_vector[1])  # ""Crecimiento"""
"0","    } else {"
"0","      return(result_vector[2])  # ""Decrecimiento"""
"0","    }"
"0","  } else {"
"0","    return(""No previous year to compare"")"
"0","  }"
"0","}"
"0",""
